<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Shaders # I. Introducción # Segun Patricio Gonzalez & Jen Lowe, los shaders son conjuntos de instrucciones que se ejecutan todas a la vez para cada píxel de la pantalla. Según esto, el código escrito debe comportarse de forma diferente dependiendo de la posición del píxel en la pantalla, operando como una función que recibe una posición y devuelve un color, y cuando se compila se ejecuta extraordinariamente rápido, esto debido a la capacidad de cómputo de las GPU, que realizan cálculos sobre hardware paralelo y funciones matemáticas especiales aceleradas por el mismo, en lugar de software."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Workshop3FR"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://feliperojas2601.github.io/VisualComputing-Showcase/workshops/workshop3NA/"><title>Workshop3FR | Showcase Template</title><link rel=manifest href=/VisualComputing-Showcase/manifest.json><link rel=icon href=/VisualComputing-Showcase/favicon.png type=image/x-icon><link rel=stylesheet href=/VisualComputing-Showcase/book.min.ab46de3e725a6415339a37bba23a0067534a37289b063c9f8d011515a63097a8.css integrity="sha256-q0bePnJaZBUzmje7ojoAZ1NKNyibBjyfjQEVFaYwl6g=" crossorigin=anonymous><script defer src=/VisualComputing-Showcase/flexsearch.min.js></script>
<script defer src=/VisualComputing-Showcase/en.search.min.7be2f0f2df1facf62f21b53e2368b59810a7fa845fbbfa2c0dc210cf67ba0443.js integrity="sha256-e+Lw8t8frPYvIbU+I2i1mBCn+oRfu/osDcIQz2e6BEM=" crossorigin=anonymous></script>
<link rel=alternate type=application/rss+xml href=https://feliperojas2601.github.io/VisualComputing-Showcase/workshops/workshop3NA/index.xml title="Showcase Template"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/VisualComputing-Showcase/><span>Showcase Template</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/VisualComputing-Showcase/members/>Members</a></li><li><a href=/VisualComputing-Showcase/workshops/>Workshops</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/VisualComputing-Showcase/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Workshop3FR</strong>
<label for=toc-control><img src=/VisualComputing-Showcase/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#shaders><strong>Shaders</strong></a><ul><li><a href=#i-introducción><strong>I. Introducción</strong></a></li><li><a href=#texturing-and-coloring><strong>Texturing and Coloring</strong></a></li><li><a href=#i-introducción-1><strong>I. Introducción</strong></a></li><li><a href=#ii-contextualización><strong>II. Contextualización</strong></a></li><li><a href=#iii-resultados><strong>III. Resultados</strong></a></li><li><a href=#image-processing><strong>Image Processing</strong></a></li><li><a href=#i-introducción-2><strong>I. Introducción</strong></a></li><li><a href=#ii-contextualización-1><strong>II. Contextualización</strong></a></li><li><a href=#iii-resultados-1><strong>III. Resultados</strong></a></li><li><a href=#procedural-texturing><strong>Procedural Texturing</strong></a></li><li><a href=#i-introducción-3><strong>I. Introducción</strong></a></li><li><a href=#ii-contextualización-2><strong>II. Contextualización</strong></a></li><li><a href=#iii-resultados-2><strong>III. Resultados</strong></a></li><li><a href=#iv-conclusiones><strong>IV. Conclusiones</strong></a></li><li><a href=#v-referencias><strong>V. Referencias</strong></a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=shaders><strong>Shaders</strong>
<a class=anchor href=#shaders>#</a></h1><div style=text-align:justify><h2 id=i-introducción><strong>I. Introducción</strong>
<a class=anchor href=#i-introducci%c3%b3n>#</a></h2><p>Segun Patricio Gonzalez & Jen Lowe, los shaders son conjuntos de instrucciones que se ejecutan todas a la vez para cada píxel de la pantalla. Según esto, el código escrito debe comportarse de forma diferente dependiendo de la posición del píxel en la pantalla, operando como una función que recibe una posición y devuelve un color, y cuando se compila se ejecuta extraordinariamente rápido, esto debido a la capacidad de cómputo de las GPU, que realizan cálculos sobre hardware paralelo y funciones matemáticas especiales aceleradas por el mismo, en lugar de software.</p><p>Hay diferentes tipos de shaders, pero hay dos que se utilizan habitualmente para crear gráficos en la web: Vertex Shaders y Fragment Shaders. Los Vertex Shaders transforman las posiciones de las formas en coordenadas de dibujo 3D. Los Fragment Shaders calculan las representaciones de los colores de una forma y otros atributos.</p><p>GLSL es el estándar específico de los shaders; el lenguaje Shader tiene una única función principal que devuelve un color al final, este color del píxel se asigna a la variable global reservada <code>gl_FragColor</code>, la cual contiene cuatro argumentos correspondientes a los canales rojo, verde, azul y alfa, valores que están normalizados.
Este lenguaje incorpora además de variables (como gl_FragColor), funciones y tipos, como vec4 que representa un vector de cuatro dimensiones (similarmente existen vec3 y vec2, o tipos reconocidos como float o bool).</p><p>La GPU gestiona un gran número de hilos paralelos, cada uno responsable de asignar el color a una fracción de la imagen total, y aunque cada hilo paralelo es ciego a los demás, se necesita poder enviar algunas entradas de la CPU a todos los hilos. Estas entradas van a ser uniformes a todos los hilos siguiendo la arquitectura de la tarjeta gráfica y se establecen como de sólo lectura. Estas entradas se llaman uniformes y se verán comunmente en cada implementación de fragment shader, por ejemplo u_time que lleva el tiempo en milisegundos desde el inicio del programa o uResolution que especifica el tamaño del canvas.</p><p>Similar a como GLSL otorga una salida por defecto, gl_FragColor, también otorga una entrada por defecto, <code>gl_FragCoord</code>, que contiene las coordenadas de pantalla del píxel o fragmento de pantalla sobre el que está trabajando el hilo activo. Con gl_FragCoord, se sabe dónde está trabajando un hilo dentro del billboard. Debido a que las coordenadas
son diferentes de un hilo a otro, en su lugar gl_FragCoord se denomina variante.</p><p>Para leer shaders desde p5.js se hace uso de la librería <code>p5.treegl</code>, mediante la función <code>readShader</code>, que carga un fragment shader desde la ruta del archivo y
devuelve un shader de p5. Esta recibe además la precisión de los flotantes del vertex shader, las matrices uniformes del vertex shader y los atributos del vertex shader para ser interpoladas al fragment shader. El vertex shader detrás del p5.shader se genera automáticamente a partir de una llamada a otra función denominada <code>parseVertexShader</code>.</p><h2 id=texturing-and-coloring><strong>Texturing and Coloring</strong>
<a class=anchor href=#texturing-and-coloring>#</a></h2><h2 id=i-introducción-1><strong>I. Introducción</strong>
<a class=anchor href=#i-introducci%c3%b3n-1>#</a></h2><p>Una textura es una imagen mapeada sobre la superficie de una forma. El mapeo de imagenes en diferentes objetos en espacios bidimensionales y tridimensionales se puede realizar de diferentes formas en GLSL, esto se explorará a continuación.</p><h2 id=ii-contextualización><strong>II. Contextualización</strong>
<a class=anchor href=#ii-contextualizaci%c3%b3n>#</a></h2><p>Para el caso de visualización UV, la textura se define en el llamado espacio uv. Las letras &ldquo;U&rdquo; y &ldquo;V&rdquo; denotan los ejes de la textura 2D resultado del mapeo realizado, porque &ldquo;X&rdquo;, &ldquo;Y&rdquo; y &ldquo;Z&rdquo; ya se utilizan para denotar los ejes del objeto 3D en model space. Así, las coordenadas de cada vértice <code>texcoords2</code>, de dos formas diferentes son mapeadas en cada fragment shader para representar un color determinado, creando un tipo de gradiente del color.</p><p>Por otro lado, el muestreo de una textura específica en coordenadas de vértice dadas requiere la llamada a <code>glsl texture2D</code> dentro del shader.
La función texture2D devuelve un texel, es decir, el valor de color de la textura para las coordenadas dadas. La función tiene un parámetro de entrada del tipo sampler2D y un parámetro de entrada del tipo vec2, correspondientes al uniforme al que está ligada la textura y las coordenadas bidimensionales del texel a buscar respectivamente.
Esta es utilizada entonces para calcular una visualización de la luminosidad de una imagen dada, por ejemplo.</p><p>Así, para la segunda implementación realizada, se muestrea una textura específica, de manera que el texel obtenido se opera de diferentes formas para aplicar un filtro a la imagen inicial. Se implementaron entonces cinco casos diferentes: inversión de los colores de cada pixel, obtención del valor <code>HSV V</code> de un pixel, obtención del valor <code>HSL L</code> o luminosidad del HSL, obtención del luma de un pixel y reducción de los canales rojo, verde y/o azul de un pixel mediante sliders respectivamente.</p><h2 id=iii-resultados><strong>III. Resultados</strong>
<a class=anchor href=#iii-resultados>#</a></h2><p>La implementación utilizando p5.js, y el editor web, realizada para los casos anteriores se muestra a continuación:</p><details><summary>sketch.js</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>easycam</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>uvShader</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Define geometry in world space (i.e., matrices: Tree.pmvMatrix).
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// The projection and modelview matrices may be emitted separately
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// (i.e., matrices: Tree.pMatrix | Tree.mvMatrix), which actually
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// leads to the same gl_Position result.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// Interpolate only texture coordinates (i.e., varyings: Tree.texcoords2).
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// see: https://github.com/VisualComputing/p5.treegl#handling
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>uvShader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>readShader</span>(<span style=color:#e6db74>&#34;uv.frag&#34;</span>, {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>matrices</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>pmvMatrix</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>varyings</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>texcoords2</span>,
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>uvShader2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>readShader</span>(<span style=color:#e6db74>&#34;uv2.frag&#34;</span>, {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>matrices</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>pmvMatrix</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>varyings</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>texcoords2</span>,
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>500</span>, <span style=color:#ae81ff>500</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>textureMode</span>(<span style=color:#a6e22e>NORMAL</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>orbitControl</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shader</span>(<span style=color:#a6e22e>uvShader2</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>quad</span>(
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shader</span>(<span style=color:#a6e22e>uvShader</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>triangle</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>mouseWheel</span>(<span style=color:#a6e22e>event</span>) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>//comment to enable page scrolling
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><br><details><summary>uv.frag</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>precision</span> <span style=color:#a6e22e>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// the texture coordinates varying was defined in
</span></span></span><span style=display:flex><span><span style=color:#75715e>// the vertex shader by treegl readShader()
</span></span></span><span style=display:flex><span><span style=color:#75715e>// open your console and &amp; see!
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>varying</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>texcoords2</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>texcoords2</span>.<span style=color:#a6e22e>x</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>texcoords2</span>.<span style=color:#a6e22e>y</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// if (texcoords2.y &gt; 0.25 &amp;&amp; texcoords2.y &lt; 0.50){
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   gl_FragColor = vec4(texcoords2.x, 0,  texcoords2.y, 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// }else if (texcoords2.y &gt; 0.50 &amp;&amp; texcoords2.x &gt; 0.50 &amp;&amp; texcoords2.x &lt; 0.75){
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   gl_FragColor = vec4(texcoords2.x, 1,  texcoords2.y, 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// }else if (texcoords2.y &gt; 0.75 &amp;&amp; texcoords2.x &lt; 0.25 ){
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   gl_FragColor = vec4(texcoords2.y, 1,  texcoords2.x, 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// }else if (texcoords2.y &lt; 0.75 &amp;&amp; texcoords2.x &gt; 0.25 &amp;&amp; texcoords2.x &lt; 0.50){
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   gl_FragColor = vec4(texcoords2.x, 0, 1, 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// }else if (texcoords2.y &lt; 0.25 &amp;&amp; texcoords2.x &lt; 0.50){
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   gl_FragColor = vec4(texcoords2.x, 1, 0, 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// }else if (texcoords2.x &gt; 0.75){
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   gl_FragColor = vec4(texcoords2.x, 0, texcoords2.y, 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// }else{
</span></span></span><span style=display:flex><span><span style=color:#75715e>//     gl_FragColor = vec4(texcoords2.xy, 0, 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// }
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div></div></details><details><summary>uv2.frag</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>precision</span> <span style=color:#a6e22e>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// the texture coordinates varying was defined in
</span></span></span><span style=display:flex><span><span style=color:#75715e>// the vertex shader by treegl readShader()
</span></span></span><span style=display:flex><span><span style=color:#75715e>// open your console and &amp; see!
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>varying</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>texcoords2</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>0.5</span>, <span style=color:#a6e22e>texcoords2</span>.<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>texcoords2</span>.<span style=color:#a6e22e>y</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// if (texcoords2.y &gt; 0.25 &amp;&amp; texcoords2.y &lt; 0.50){
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   gl_FragColor = vec4(texcoords2.x, 0,  texcoords2.y, 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// }else if (texcoords2.y &gt; 0.50 &amp;&amp; texcoords2.x &gt; 0.50 &amp;&amp; texcoords2.x &lt; 0.75){
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   gl_FragColor = vec4(texcoords2.x, 1,  texcoords2.y, 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// }else if (texcoords2.y &gt; 0.75 &amp;&amp; texcoords2.x &lt; 0.25 ){
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   gl_FragColor = vec4(texcoords2.y, 1,  texcoords2.x, 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// }else if (texcoords2.y &lt; 0.75 &amp;&amp; texcoords2.x &gt; 0.25 &amp;&amp; texcoords2.x &lt; 0.50){
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   gl_FragColor = vec4(texcoords2.x, 0, 1, 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// }else if (texcoords2.y &lt; 0.25 &amp;&amp; texcoords2.x &lt; 0.50){
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   gl_FragColor = vec4(texcoords2.x, 1, 0, 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// }else if (texcoords2.x &gt; 0.75){
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   gl_FragColor = vec4(texcoords2.x, 0, texcoords2.y, 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// }else{
</span></span></span><span style=display:flex><span><span style=color:#75715e>//     gl_FragColor = vec4(texcoords2.xy, 0, 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// }
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div></div></details><br><div align=center><iframe src=https://editor.p5js.org/wnarevalor/full/z3Qh5H9Sc width=500 height=550></iframe></div><br><details><summary>sketch.js</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>lumaShader</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>grey_scale</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rslider</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>gslider</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>easycam</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>bslider</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lumaShader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>readShader</span>(<span style=color:#e6db74>&#34;luma.frag&#34;</span>, { <span style=color:#a6e22e>varyings</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>texcoords2</span> });
</span></span><span style=display:flex><span>  <span style=color:#75715e>// image source: https://images.unsplash.com/photo-1610683468005-79e792efddd9?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxzZWFyY2h8MTB8fGdsYXNzJTIwcGFuZWx8ZW58MHx8MHx8&amp;w=1000&amp;q=80
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#34;images/colors.jpg&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>600</span>, <span style=color:#ae81ff>800</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rslider</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSlider</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0.01</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rslider</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rslider</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;width&#34;</span>, <span style=color:#e6db74>&#34;80px&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gslider</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSlider</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0.01</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gslider</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>40</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gslider</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;width&#34;</span>, <span style=color:#e6db74>&#34;80px&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bslider</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSlider</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0.01</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bslider</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>70</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bslider</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;width&#34;</span>, <span style=color:#e6db74>&#34;80px&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>textureMode</span>(<span style=color:#a6e22e>IMAGE</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shader</span>(<span style=color:#a6e22e>lumaShader</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>inverted</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createCheckbox</span>(<span style=color:#e6db74>&#34;inverse&#34;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>inverted</span>.<span style=color:#a6e22e>position</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>inverted</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;color&#34;</span>, <span style=color:#e6db74>&#34;white&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>inverted</span>.<span style=color:#a6e22e>input</span>(() =&gt; <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;inverted&#34;</span>, <span style=color:#a6e22e>inverted</span>.<span style=color:#a6e22e>checked</span>()));
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hsv</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createCheckbox</span>(<span style=color:#e6db74>&#34;hsv&#34;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hsv</span>.<span style=color:#a6e22e>position</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>30</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hsv</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;color&#34;</span>, <span style=color:#e6db74>&#34;white&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hsv</span>.<span style=color:#a6e22e>input</span>(() =&gt; <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;hsv&#34;</span>, <span style=color:#a6e22e>hsv</span>.<span style=color:#a6e22e>checked</span>()));
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hsl</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createCheckbox</span>(<span style=color:#e6db74>&#34;hsl&#34;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hsl</span>.<span style=color:#a6e22e>position</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hsl</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;color&#34;</span>, <span style=color:#e6db74>&#34;white&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hsl</span>.<span style=color:#a6e22e>input</span>(() =&gt; <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;hsl&#34;</span>, <span style=color:#a6e22e>hsl</span>.<span style=color:#a6e22e>checked</span>()));
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>luma</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createCheckbox</span>(<span style=color:#e6db74>&#34;luma&#34;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>luma</span>.<span style=color:#a6e22e>position</span>(<span style=color:#a6e22e>width</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>70</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>luma</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;color&#34;</span>, <span style=color:#e6db74>&#34;white&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>luma</span>.<span style=color:#a6e22e>input</span>(() =&gt; <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;luma&#34;</span>, <span style=color:#a6e22e>luma</span>.<span style=color:#a6e22e>checked</span>()));
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rslider</span>.<span style=color:#a6e22e>changed</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;r_scale&#34;</span>, <span style=color:#a6e22e>rslider</span>.<span style=color:#a6e22e>value</span>());
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gslider</span>.<span style=color:#a6e22e>changed</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;g_scale&#34;</span>, <span style=color:#a6e22e>gslider</span>.<span style=color:#a6e22e>value</span>());
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bslider</span>.<span style=color:#a6e22e>changed</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;b_scale&#34;</span>, <span style=color:#a6e22e>bslider</span>.<span style=color:#a6e22e>value</span>());
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;texture&#34;</span>, <span style=color:#a6e22e>img</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>quad</span>(
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><br><details><summary>luma.frag</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>precision</span> <span style=color:#a6e22e>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// uniforms are defined and sent by the sketch
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>inverted</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>hsv</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>luma</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>hsl</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>r_scale</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>g_scale</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>b_scale</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>sampler2D</span> <span style=color:#a6e22e>texture</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// interpolated texcoord (same name and type as in vertex shader)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>varying</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>texcoords2</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// returns luma of given texel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>lum</span>(<span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>texel</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0.299</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.587</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.114</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>b</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>hsvV</span>(<span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>texel</span>){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>r</span>, <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>g</span>), <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>b</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>hslL</span>(<span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>texel</span>){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>max</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>hsvV</span>(<span style=color:#a6e22e>texel</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>min</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>min</span>(<span style=color:#a6e22e>min</span>(<span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>r</span>, <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>g</span>), <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>b</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (<span style=color:#a6e22e>max</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>min</span>)<span style=color:#f92672>/</span><span style=color:#ae81ff>2.0</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// texture2D(texture, texcoords2) samples texture at texcoords2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// and returns the normalized texel color
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>texel</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>texture</span>, <span style=color:#a6e22e>texcoords2</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>inverted</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>vec4</span>((<span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>1.0</span>, <span style=color:#ae81ff>1.0</span>, <span style=color:#ae81ff>1.0</span>) <span style=color:#f92672>-</span> <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>rgb</span>), <span style=color:#ae81ff>1.0</span>) <span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>hsv</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>vec3</span>(<span style=color:#a6e22e>hsvV</span>(<span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>rgb</span>)), <span style=color:#ae81ff>1.0</span>) <span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>hsl</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>vec3</span>(<span style=color:#a6e22e>hslL</span>(<span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>rgb</span>)), <span style=color:#ae81ff>1.0</span>) <span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>luma</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>vec3</span>(<span style=color:#a6e22e>lum</span>(<span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>rgb</span>)), <span style=color:#ae81ff>1.0</span>) <span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>vec3</span>(<span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>r_scale</span>, <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>g_scale</span>, <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>b</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>b_scale</span>), <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><br><div align=center><iframe src=https://editor.p5js.org/wnarevalor/full/_d3UIbEF4 width=600 height=800></iframe></div><br><h2 id=image-processing><strong>Image Processing</strong>
<a class=anchor href=#image-processing>#</a></h2><h2 id=i-introducción-2><strong>I. Introducción</strong>
<a class=anchor href=#i-introducci%c3%b3n-2>#</a></h2><p>El procesamiento digital de imágenes es el uso de un ordenador digital para procesar imágenes digitales mediante un algoritmo.
Algunas transformaciones de imágenes digitales son</p><ul><li>Filtrado: Se utilizan para difuminar, dar nitidez a las imágenes digitales u otros efectos.
Este filtrado se puede realizar mediante matrices de convolución específicamente diseñados en el dominio espacial o enmascaramiento de regiones de frecuencia específicas en el dominio de la frecuencia.</li><li>Transformaciones afines: Permiten transformaciones básicas de la imagen, incluyendo escalamiento, rotación, traslación, reflejo y cizallamiento, como se ha visto en las lecciones anteriores.</li><li>Desnaturalización de imágenes con morfología: Permiten la eliminación de ruido de las imágenes.</li></ul><p>Para este caso se realizó filtering mediante mascaras, de manera que se tienen en cuenta las coordenadas de textura de los pixeles vecinos.</p><h2 id=ii-contextualización-1><strong>II. Contextualización</strong>
<a class=anchor href=#ii-contextualizaci%c3%b3n-1>#</a></h2><p>Como se ha mencionado en sesiones de clase, en WEBGL la textura se utiliza para implementar el procesamiento de imágenes y como se sabe hacer referencia a otros píxeles, se utilizaron matrices de convolución 3x3, en la que cada entrada de la matriz representa cuánto hay que multiplicar los 8 píxeles alrededor del píxel que estamos renderizando.
Según esto, se aplicaron las matrices <code>[-1, -1, -1, -1, 8, -1, -1, -1, -1]</code>, <code>[1, 2, 1, 0, 0, 0, -1, -2, -1]</code>, <code>[-2, -1, 0, -1, 1, 1, 0, 1, 2]</code> para obtener filtros de blanco y negro, sobel horizontal y realzado respectivamente, las cuales fueron tomadas de <em>WebGLFundamentals</em>. Se utilizó la función <code>distance</code> de glsl para evidenciar el efecto de las máscaras en una región circular de la imagen que depende de la posición del mouse. Similarmente, se aplicaron otros efectos a la región como luma y el valor HSV V.</p><p>Además, se implementó un efecto de lupa que amplía una región de pixeles con un radio y profundidad definidos. La implementación realizada fue basada en un shader realizado por el usuario <em>wawan60</em> en la plataforma Shadertoy, la cual se encuentra en el siguiente enlace: <a href=https://www.shadertoy.com/view/llsSz7>https://www.shadertoy.com/view/llsSz7</a></p><h2 id=iii-resultados-1><strong>III. Resultados</strong>
<a class=anchor href=#iii-resultados-1>#</a></h2><p>La implementación utilizando p5.js, y el editor web, realizada para los casos anteriores se muestra a continuación:</p><details><summary>sketch.js</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>maskShader</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>luma</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>video_src</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>video_on</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mask</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>maskShader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>readShader</span>(<span style=color:#e6db74>&#34;mask.frag&#34;</span>, { <span style=color:#a6e22e>varyings</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>texcoords2</span> });
</span></span><span style=display:flex><span>  <span style=color:#75715e>//source: https://images.unsplash.com/photo-1610683468005-79e792efddd9?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxzZWFyY2h8MTB8fGdsYXNzJTIwcGFuZWx8ZW58MHx8MHx8&amp;w=1000&amp;q=80
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#34;images/colors.jpg&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// shaders require WEBGL mode to work
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>600</span>, <span style=color:#ae81ff>800</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>textureMode</span>(<span style=color:#a6e22e>NORMAL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>other</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createCheckbox</span>(<span style=color:#e6db74>&#34;region&#34;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>other</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>other</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;color&#34;</span>, <span style=color:#e6db74>&#34;white&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>other</span>.<span style=color:#a6e22e>input</span>(() =&gt; <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;region&#34;</span>, <span style=color:#a6e22e>other</span>.<span style=color:#a6e22e>checked</span>()));
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>luma</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createCheckbox</span>(<span style=color:#e6db74>&#34;luma&#34;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>luma</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>30</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>luma</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;color&#34;</span>, <span style=color:#e6db74>&#34;white&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>luma</span>.<span style=color:#a6e22e>input</span>(() =&gt; <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;luma&#34;</span>, <span style=color:#a6e22e>luma</span>.<span style=color:#a6e22e>checked</span>()));
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hsv</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createCheckbox</span>(<span style=color:#e6db74>&#34;hsv&#34;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hsv</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hsv</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;color&#34;</span>, <span style=color:#e6db74>&#34;white&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hsv</span>.<span style=color:#a6e22e>input</span>(() =&gt; <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;hsv&#34;</span>, <span style=color:#a6e22e>hsv</span>.<span style=color:#a6e22e>checked</span>()));
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sobel</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createCheckbox</span>(<span style=color:#e6db74>&#34;sobel&#34;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sobel</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>70</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sobel</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;color&#34;</span>, <span style=color:#e6db74>&#34;white&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>emboss</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createCheckbox</span>(<span style=color:#e6db74>&#34;emboss&#34;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>emboss</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>90</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>emboss</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;color&#34;</span>, <span style=color:#e6db74>&#34;white&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shader</span>(<span style=color:#a6e22e>maskShader</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;texture&#34;</span>, <span style=color:#a6e22e>img</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>emitTexOffset</span>(<span style=color:#a6e22e>maskShader</span>, <span style=color:#a6e22e>img</span>, <span style=color:#e6db74>&#34;texOffset&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;mask&#34;</span>, [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>mouseX</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>width</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>my</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>mouseY</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>height</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;uResolution&#34;</span>, [<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>]);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;uMouse&#34;</span>, [<span style=color:#a6e22e>mx</span>, <span style=color:#a6e22e>my</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>//kernels taken from https://webglfundamentals.org/webgl/lessons/webgl-image-processing.html
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>other</span>.<span style=color:#a6e22e>checked</span>()) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;mask&#34;</span>, [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>8</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>sobel</span>.<span style=color:#a6e22e>checked</span>()) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;mask&#34;</span>, [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>emboss</span>.<span style=color:#a6e22e>checked</span>()) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;mask&#34;</span>, [<span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>]);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;mask&#34;</span>, [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>quad</span>(
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><br><details><summary>mask.frag</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>ifdef</span> <span style=color:#a6e22e>GL_ES</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>precision</span> <span style=color:#a6e22e>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>endif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>precision</span> <span style=color:#a6e22e>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>sampler2D</span> <span style=color:#a6e22e>texture</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>texOffset</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>uMouse</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>region</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>luma</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>hsv</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>uResolution</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// holds the 3x3 kernel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>uniform</span> <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>mask</span>[<span style=color:#ae81ff>9</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// we need our interpolated tex coord
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>varying</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>texcoords2</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>radius</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0.2</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>depth</span><span style=color:#f92672>=</span><span style=color:#a6e22e>radius</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2.</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>lum</span>(<span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>texel</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0.299</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>r</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.587</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>g</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.114</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>b</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>hsvV</span>(<span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>texel</span>){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>r</span>, <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>g</span>), <span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>b</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 1. Use offset to move along texture space.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// In this case to find the texcoords of the texel neighbours.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>tc0</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texcoords2</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>vec2</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>texOffset</span>.<span style=color:#a6e22e>s</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>texOffset</span>.<span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>tc1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texcoords2</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>vec2</span>(         <span style=color:#ae81ff>0.0</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>texOffset</span>.<span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>tc2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texcoords2</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>vec2</span>(<span style=color:#f92672>+</span><span style=color:#a6e22e>texOffset</span>.<span style=color:#a6e22e>s</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>texOffset</span>.<span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>tc3</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texcoords2</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>vec2</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>texOffset</span>.<span style=color:#a6e22e>s</span>,          <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>  <span style=color:#75715e>// origin (current fragment texcoords)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>tc4</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texcoords2</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>vec2</span>(         <span style=color:#ae81ff>0.0</span>,          <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>tc5</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texcoords2</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>vec2</span>(<span style=color:#f92672>+</span><span style=color:#a6e22e>texOffset</span>.<span style=color:#a6e22e>s</span>,          <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>tc6</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texcoords2</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>vec2</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>texOffset</span>.<span style=color:#a6e22e>s</span>, <span style=color:#f92672>+</span><span style=color:#a6e22e>texOffset</span>.<span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>tc7</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texcoords2</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>vec2</span>(         <span style=color:#ae81ff>0.0</span>, <span style=color:#f92672>+</span><span style=color:#a6e22e>texOffset</span>.<span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>tc8</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texcoords2</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>vec2</span>(<span style=color:#f92672>+</span><span style=color:#a6e22e>texOffset</span>.<span style=color:#a6e22e>s</span>, <span style=color:#f92672>+</span><span style=color:#a6e22e>texOffset</span>.<span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 2. Sample texel neighbours within the rgba array
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>rgba</span>[<span style=color:#ae81ff>9</span>];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rgba</span>[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>texture</span>, <span style=color:#a6e22e>tc0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rgba</span>[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>texture</span>, <span style=color:#a6e22e>tc1</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rgba</span>[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>texture</span>, <span style=color:#a6e22e>tc2</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rgba</span>[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>texture</span>, <span style=color:#a6e22e>tc3</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rgba</span>[<span style=color:#ae81ff>4</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>texture</span>, <span style=color:#a6e22e>tc4</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rgba</span>[<span style=color:#ae81ff>5</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>texture</span>, <span style=color:#a6e22e>tc5</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rgba</span>[<span style=color:#ae81ff>6</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>texture</span>, <span style=color:#a6e22e>tc6</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rgba</span>[<span style=color:#ae81ff>7</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>texture</span>, <span style=color:#a6e22e>tc7</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rgba</span>[<span style=color:#ae81ff>8</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>texture</span>, <span style=color:#a6e22e>tc8</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 3. Apply convolution kernel
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>texture</span>, <span style=color:#a6e22e>texcoords2</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>uv</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>gl_FragCoord</span>.<span style=color:#a6e22e>xy</span><span style=color:#f92672>/</span>(<span style=color:#a6e22e>uResolution</span>.<span style=color:#a6e22e>xy</span>);
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>center</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec2</span>(<span style=color:#a6e22e>uMouse</span>.<span style=color:#a6e22e>x</span>, <span style=color:#ae81ff>1.0</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>uMouse</span>.<span style=color:#a6e22e>y</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>distance</span>(<span style=color:#a6e22e>uv</span>, <span style=color:#a6e22e>center</span>) <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>radius</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>convolution</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>9</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>convolution</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>rgba</span>[<span style=color:#a6e22e>i</span>]<span style=color:#f92672>*</span><span style=color:#a6e22e>mask</span>[<span style=color:#a6e22e>i</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>region</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>vec3</span>(<span style=color:#a6e22e>convolution</span>.<span style=color:#a6e22e>r</span><span style=color:#f92672>+</span><span style=color:#a6e22e>convolution</span>.<span style=color:#a6e22e>g</span><span style=color:#f92672>+</span><span style=color:#a6e22e>convolution</span>.<span style=color:#a6e22e>b</span>)<span style=color:#f92672>/</span><span style=color:#ae81ff>3.0</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>    }<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>luma</span>){
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>vec3</span>(<span style=color:#a6e22e>lum</span>(<span style=color:#a6e22e>color</span>.<span style=color:#a6e22e>rgb</span>)), <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>    }<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>hsv</span>){
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>vec3</span>(<span style=color:#a6e22e>hsvV</span>(<span style=color:#a6e22e>color</span>.<span style=color:#a6e22e>rgb</span>)), <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>    }<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>     <span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>convolution</span>.<span style=color:#a6e22e>rgb</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>     <span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>color</span>.<span style=color:#a6e22e>rgb</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><br><div align=center><iframe src=https://editor.p5js.org/wnarevalor/full/c-HU5MlXB width=600 height=800></iframe></div><br><details><summary>sketch.js</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>maskShader</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>luma</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>video_src</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>video_on</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mask</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>maskShader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>readShader</span>(<span style=color:#e6db74>&#34;mask.frag&#34;</span>, {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>varyings</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>texcoords2</span>,
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>//source: https://kushfineart.com/artworks/categories/8/9501-metamorphosis-ii/
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#34;images/metamorphosis.jpg&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// shaders require WEBGL mode to work
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>650</span>, <span style=color:#ae81ff>550</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>textureMode</span>(<span style=color:#a6e22e>NORMAL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mask</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createCheckbox</span>(<span style=color:#e6db74>&#34;magnifier&#34;</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mask</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mask</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#34;color&#34;</span>, <span style=color:#e6db74>&#34;white&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shader</span>(<span style=color:#a6e22e>maskShader</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;texture&#34;</span>, <span style=color:#a6e22e>img</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>emitTexOffset</span>(<span style=color:#a6e22e>maskShader</span>, <span style=color:#a6e22e>img</span>, <span style=color:#e6db74>&#34;texOffset&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>mask</span>.<span style=color:#a6e22e>checked</span>()) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;magnifier&#34;</span>, <span style=color:#a6e22e>mask</span>.<span style=color:#a6e22e>checked</span>());
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>mouseX</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>width</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>my</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>mouseY</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>height</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;uResolution&#34;</span>, [<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span>]);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;uMouse&#34;</span>, [<span style=color:#a6e22e>mx</span>, <span style=color:#a6e22e>my</span>]);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>maskShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;magnifier&#34;</span>, <span style=color:#a6e22e>mask</span>.<span style=color:#a6e22e>checked</span>());
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>quad</span>(
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span><span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><br><details><summary>mask.frag</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>//adapted from https://www.shadertoy.com/view/llsSz7 by wawan60
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>precision</span> <span style=color:#a6e22e>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>sampler2D</span> <span style=color:#a6e22e>texture</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>texOffset</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>uMouse</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>magnifier</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>uResolution</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// we need our interpolated tex coord
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>varying</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>texcoords2</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>radius</span><span style=color:#f92672>=</span>.<span style=color:#ae81ff>5</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>depth</span><span style=color:#f92672>=</span><span style=color:#a6e22e>radius</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1.8</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>texel</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>texture</span>, <span style=color:#a6e22e>texcoords2</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>uv</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>gl_FragCoord</span>.<span style=color:#a6e22e>xy</span><span style=color:#f92672>/</span>(<span style=color:#a6e22e>uResolution</span>.<span style=color:#a6e22e>xy</span>);
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>center</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec2</span>(<span style=color:#a6e22e>uMouse</span>.<span style=color:#a6e22e>x</span>, <span style=color:#ae81ff>1.0</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>uMouse</span>.<span style=color:#a6e22e>y</span>);
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>float</span> <span style=color:#a6e22e>ax</span> <span style=color:#f92672>=</span> ((<span style=color:#a6e22e>uv</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>center</span>.<span style=color:#a6e22e>x</span>)<span style=color:#f92672>*</span> (<span style=color:#a6e22e>uv</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>center</span>.<span style=color:#a6e22e>x</span>)) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>0.2</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.2</span>) <span style=color:#f92672>+</span> ((<span style=color:#a6e22e>uv</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>center</span>.<span style=color:#a6e22e>y</span>) <span style=color:#f92672>*</span> (<span style=color:#a6e22e>uv</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>center</span>.<span style=color:#a6e22e>y</span>)) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>0.1</span><span style=color:#f92672>/</span> (  <span style=color:#a6e22e>uResolution</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>uResolution</span>.<span style=color:#a6e22e>y</span> )) ;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>float</span> <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> (<span style=color:#f92672>-</span><span style=color:#a6e22e>depth</span><span style=color:#f92672>/</span><span style=color:#a6e22e>radius</span>)<span style=color:#f92672>*</span><span style=color:#a6e22e>ax</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>depth</span><span style=color:#f92672>/</span>(<span style=color:#a6e22e>radius</span><span style=color:#f92672>*</span><span style=color:#a6e22e>radius</span>))<span style=color:#f92672>*</span><span style=color:#a6e22e>ax</span><span style=color:#f92672>*</span><span style=color:#a6e22e>ax</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span>  (<span style=color:#a6e22e>ax</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>dx</span>);
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>ax</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>radius</span>) <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ax</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>magnifierArea</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>center</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>uv</span><span style=color:#f92672>-</span><span style=color:#a6e22e>center</span>)<span style=color:#f92672>*</span><span style=color:#a6e22e>f</span><span style=color:#f92672>/</span><span style=color:#a6e22e>ax</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>magnifier_r</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec2</span>(<span style=color:#a6e22e>magnifierArea</span>.<span style=color:#a6e22e>x</span>, <span style=color:#ae81ff>1.0</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>magnifierArea</span>.<span style=color:#a6e22e>y</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>texture2D</span>(<span style=color:#a6e22e>texture</span>, <span style=color:#a6e22e>magnifier_r</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>magnifier</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>color</span>.<span style=color:#a6e22e>rgb</span>, <span style=color:#ae81ff>1.0</span>) <span style=color:#f92672>:</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#a6e22e>texel</span>.<span style=color:#a6e22e>rgb</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><br><div align=center><iframe src=https://editor.p5js.org/wnarevalor/full/Frzgf12RT width=650 height=550></iframe></div><br><h2 id=procedural-texturing><strong>Procedural Texturing</strong>
<a class=anchor href=#procedural-texturing>#</a></h2><h2 id=i-introducción-3><strong>I. Introducción</strong>
<a class=anchor href=#i-introducci%c3%b3n-3>#</a></h2><p>El texturizado procedimental busca generar una textura utilizando una descripción matemática o un algoritmo en lugar de datos almacenados directamente como una imagen, de manera que el resultado puede ser mapeado en una forma como una textura cualquiera. Este tipo de texturas se suelen utilizar para modelar representaciones superficiales o volumétricas de elementos naturales como la madera, el mármol, el granito, el metal, la piedra y otros. El texturizado procedimental requiere el uso de un objeto frame buffer que en p5.js se implementa como un objeto p5.Graphics.</p><h2 id=ii-contextualización-2><strong>II. Contextualización</strong>
<a class=anchor href=#ii-contextualizaci%c3%b3n-2>#</a></h2><p>Para este caso, se utilizan dos texturas similares tomadas de Shadertoy, implementadas por Inigo Quilez (co-creador de Shadertoy), las cuales son mapeadas a una caja o cubo de p5.
Ambas texturas utilizan el tiempo del programa <code>(función millis() de p5.js)</code> para cambiar la variable uniforme en el shader que permite simular el movimiento de la textura.</p><h2 id=iii-resultados-2><strong>III. Resultados</strong>
<a class=anchor href=#iii-resultados-2>#</a></h2><p>La implementación utilizando p5.js y el editor web realizada para los casos anteriores se muestra a continuación:</p><details><summary>sketch.js</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>pg</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>truchetShader</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// shader adapted from here: https://thebookofshaders.com/09/
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>truchetShader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>readShader</span>(<span style=color:#e6db74>&#34;truchet.frag&#34;</span>, {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>matrices</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>NONE</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>varyings</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>NONE</span>,
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>700</span>, <span style=color:#ae81ff>700</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  <span style=color:#75715e>// create frame buffer object to render the procedural texture
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>pg</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createGraphics</span>(<span style=color:#ae81ff>700</span>, <span style=color:#ae81ff>700</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  <span style=color:#75715e>// textureMode(NORMAL);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// noStroke();
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>textureMode</span>(<span style=color:#a6e22e>NORMAL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pg</span>.<span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pg</span>.<span style=color:#a6e22e>shader</span>(<span style=color:#a6e22e>truchetShader</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pg</span>.<span style=color:#a6e22e>emitResolution</span>(<span style=color:#a6e22e>truchetShader</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>truchetShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;u_zoom&#34;</span>, <span style=color:#ae81ff>3</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>33</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pg</span>.<span style=color:#a6e22e>quad</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>texture</span>(<span style=color:#a6e22e>pg</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>orbitControl</span>();
</span></span><span style=display:flex><span>  <span style=color:#75715e>// rotateX(millis() / 1000);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// rotateY(millis() / 1000);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>emitMousePosition</span>(<span style=color:#a6e22e>truchetShader</span>, <span style=color:#e6db74>&#34;mouse&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>truchetShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#34;u_time&#34;</span>, <span style=color:#66d9ef>float</span>(<span style=color:#a6e22e>millis</span>() <span style=color:#f92672>/</span> <span style=color:#ae81ff>50.0</span>));
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>box</span>(<span style=color:#ae81ff>300</span>, <span style=color:#ae81ff>300</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>mouseMoved</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>//manual time update on mouse moved
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>pg</span>.<span style=color:#a6e22e>quad</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><br><details><summary>truchet.frag</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// Author @iq - (https://iquilezles.org) - 2013
</span></span></span><span style=display:flex><span><span style=color:#75715e>//taken from https://www.shadertoy.com/view/lsl3RH
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>ifdef</span> <span style=color:#a6e22e>GL_ES</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>precision</span> <span style=color:#a6e22e>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>endif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>define</span> <span style=color:#a6e22e>PI</span> <span style=color:#ae81ff>3.14159265358979323846</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>u_resolution</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>u_time</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>// uniform float u_zoom;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mat2</span> <span style=color:#a6e22e>m</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mat2</span>( <span style=color:#ae81ff>0.80</span>,  <span style=color:#ae81ff>0.60</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0.60</span>,  <span style=color:#ae81ff>0.80</span> );
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>noise</span>( <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>p</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>sin</span>(<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>x</span>)<span style=color:#f92672>*</span><span style=color:#a6e22e>sin</span>(<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>y</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>fbm4</span>( <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>p</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.5000</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> ); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>m</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.02</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.2500</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> ); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>m</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.03</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.1250</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> ); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>m</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.01</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.0625</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> );
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>f</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0.9375</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>fbm6</span>( <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>p</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.500000</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>0.5</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> )); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>m</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.02</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.250000</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>0.5</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> )); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>m</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.03</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.125000</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>0.5</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> )); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>m</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.01</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.062500</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>0.5</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> )); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>m</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.04</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.031250</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>0.5</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> )); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>m</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.01</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.015625</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>0.5</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> ));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>f</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0.96875</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>fbm4_2</span>( <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>p</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>vec2</span>(<span style=color:#a6e22e>fbm4</span>(<span style=color:#a6e22e>p</span>), <span style=color:#a6e22e>fbm4</span>(<span style=color:#a6e22e>p</span><span style=color:#f92672>+</span><span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>7.8</span>)));
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>fbm6_2</span>( <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>p</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>vec2</span>(<span style=color:#a6e22e>fbm6</span>(<span style=color:#a6e22e>p</span><span style=color:#f92672>+</span><span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>16.8</span>)), <span style=color:#a6e22e>fbm6</span>(<span style=color:#a6e22e>p</span><span style=color:#f92672>+</span><span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>11.5</span>)));
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//====================================================================
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>fck</span>( <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>q</span>, <span style=color:#a6e22e>out</span> <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>ron</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>q</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.03</span><span style=color:#f92672>*</span><span style=color:#a6e22e>sin</span>( <span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>0.27</span>,<span style=color:#ae81ff>0.23</span>)<span style=color:#f92672>*</span><span style=color:#a6e22e>u_time</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>length</span>(<span style=color:#a6e22e>q</span>)<span style=color:#f92672>*</span><span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>4.1</span>,<span style=color:#ae81ff>4.3</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>o</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fbm4_2</span>( <span style=color:#ae81ff>0.9</span><span style=color:#f92672>*</span><span style=color:#a6e22e>q</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>o</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.04</span><span style=color:#f92672>*</span><span style=color:#a6e22e>sin</span>( <span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>0.12</span>,<span style=color:#ae81ff>0.14</span>)<span style=color:#f92672>*</span><span style=color:#a6e22e>u_time</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>length</span>(<span style=color:#a6e22e>o</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>n</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fbm6_2</span>( <span style=color:#ae81ff>3.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>o</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>ron</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>( <span style=color:#a6e22e>o</span>, <span style=color:#a6e22e>n</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>fbm4</span>( <span style=color:#ae81ff>1.8</span><span style=color:#f92672>*</span><span style=color:#a6e22e>q</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>6.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>n</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>mix</span>( <span style=color:#a6e22e>f</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>*</span><span style=color:#a6e22e>f</span><span style=color:#f92672>*</span><span style=color:#a6e22e>f</span><span style=color:#f92672>*</span><span style=color:#ae81ff>3.5</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>*</span><span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>x</span>) );
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>void</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> (<span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>gl_FragCoord</span>.<span style=color:#a6e22e>xy</span><span style=color:#f92672>-</span><span style=color:#a6e22e>u_resolution</span>.<span style=color:#a6e22e>xy</span>)<span style=color:#f92672>/</span><span style=color:#a6e22e>u_resolution</span>.<span style=color:#a6e22e>y</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>e</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span><span style=color:#f92672>/</span><span style=color:#a6e22e>u_resolution</span>.<span style=color:#a6e22e>y</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>on</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>(<span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fck</span>(<span style=color:#a6e22e>p</span>, <span style=color:#a6e22e>on</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mix</span>( <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.2</span>,<span style=color:#ae81ff>0.1</span>,<span style=color:#ae81ff>0.4</span>), <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.3</span>,<span style=color:#ae81ff>0.05</span>,<span style=color:#ae81ff>0.05</span>), <span style=color:#a6e22e>f</span> );
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mix</span>( <span style=color:#a6e22e>col</span>, <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.9</span>,<span style=color:#ae81ff>0.9</span>,<span style=color:#ae81ff>0.9</span>), <span style=color:#a6e22e>dot</span>(<span style=color:#a6e22e>on</span>.<span style=color:#a6e22e>zw</span>,<span style=color:#a6e22e>on</span>.<span style=color:#a6e22e>zw</span>) );
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mix</span>( <span style=color:#a6e22e>col</span>, <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.4</span>,<span style=color:#ae81ff>0.3</span>,<span style=color:#ae81ff>0.3</span>), <span style=color:#ae81ff>0.2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>on</span>.<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>on</span>.<span style=color:#a6e22e>y</span> );
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mix</span>( <span style=color:#a6e22e>col</span>, <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.0</span>,<span style=color:#ae81ff>0.2</span>,<span style=color:#ae81ff>0.4</span>), <span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>smoothstep</span>(<span style=color:#ae81ff>1.2</span>,<span style=color:#ae81ff>1.3</span>,<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>on</span>.<span style=color:#a6e22e>z</span>)<span style=color:#f92672>+</span><span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>on</span>.<span style=color:#a6e22e>w</span>)) );
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>clamp</span>( <span style=color:#a6e22e>col</span><span style=color:#f92672>*</span><span style=color:#a6e22e>f</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>1.0</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#66d9ef>if</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// gpu derivatives - bad quality, but fast
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>nor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>normalize</span>( <span style=color:#a6e22e>vec3</span>( <span style=color:#a6e22e>dFdx</span>(<span style=color:#a6e22e>f</span>)<span style=color:#f92672>*</span><span style=color:#a6e22e>u_resolution</span>.<span style=color:#a6e22e>x</span>, <span style=color:#ae81ff>6.0</span>, <span style=color:#a6e22e>dFdy</span>(<span style=color:#a6e22e>f</span>)<span style=color:#f92672>*</span><span style=color:#a6e22e>u_resolution</span>.<span style=color:#a6e22e>y</span> ) );
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// manual derivatives - better quality, but slower
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>vec4</span> <span style=color:#a6e22e>kk</span>;
</span></span><span style=display:flex><span> 	<span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>nor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>normalize</span>( <span style=color:#a6e22e>vec3</span>( <span style=color:#a6e22e>fck</span>(<span style=color:#a6e22e>p</span><span style=color:#f92672>+</span><span style=color:#a6e22e>vec2</span>(<span style=color:#a6e22e>e</span>,<span style=color:#ae81ff>0.0</span>),<span style=color:#a6e22e>kk</span>)<span style=color:#f92672>-</span><span style=color:#a6e22e>f</span>,
</span></span><span style=display:flex><span>                                <span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>e</span>,
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>fck</span>(<span style=color:#a6e22e>p</span><span style=color:#f92672>+</span><span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>0.0</span>,<span style=color:#a6e22e>e</span>),<span style=color:#a6e22e>kk</span>)<span style=color:#f92672>-</span><span style=color:#a6e22e>f</span> ) );
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>endif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>lig</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>normalize</span>( <span style=color:#a6e22e>vec3</span>( <span style=color:#ae81ff>0.9</span>, <span style=color:#ae81ff>0.2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0.4</span> ) );
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>dif</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>clamp</span>( <span style=color:#ae81ff>0.3</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0.7</span><span style=color:#f92672>*</span><span style=color:#a6e22e>dot</span>( <span style=color:#a6e22e>nor</span>, <span style=color:#a6e22e>lig</span> ), <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>1.0</span> );
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>lin</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.90</span>,<span style=color:#ae81ff>0.90</span>,<span style=color:#ae81ff>0.40</span>)<span style=color:#f92672>*</span>(<span style=color:#a6e22e>nor</span>.<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.5</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>+</span> <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.15</span>,<span style=color:#ae81ff>0.10</span>,<span style=color:#ae81ff>0.05</span>)<span style=color:#f92672>*</span><span style=color:#a6e22e>dif</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>col</span> <span style=color:#f92672>*=</span> <span style=color:#ae81ff>1.2</span><span style=color:#f92672>*</span><span style=color:#a6e22e>lin</span>;
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>col</span>;
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.1</span><span style=color:#f92672>*</span><span style=color:#a6e22e>col</span><span style=color:#f92672>*</span><span style=color:#a6e22e>col</span><span style=color:#f92672>*</span><span style=color:#a6e22e>col</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>( <span style=color:#a6e22e>col</span>, <span style=color:#ae81ff>1.0</span> );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><br><div align=center><iframe src=https://editor.p5js.org/wnarevalor/full/swcDtHReC width=700 height=700></iframe></div><br><details><summary>truchet.frag</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// Author @iq - (https://iquilezles.org) - 2013
</span></span></span><span style=display:flex><span><span style=color:#75715e>//Taken from https://www.shadertoy.com/view/4s23zz
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>ifdef</span> <span style=color:#a6e22e>GL_ES</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>precision</span> <span style=color:#a6e22e>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>endif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>define</span> <span style=color:#a6e22e>PI</span> <span style=color:#ae81ff>3.14159265358979323846</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>u_resolution</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>uniform</span> <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>u_time</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>define</span> <span style=color:#a6e22e>AA</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>hash</span>(<span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>p</span>)  <span style=color:#75715e>// replace this by something better
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>p</span>  <span style=color:#f92672>=</span> <span style=color:#a6e22e>fract</span>( <span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.6180339887</span> );
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>p</span> <span style=color:#f92672>*=</span> <span style=color:#ae81ff>25.0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>fract</span>( <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span>(<span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>x</span><span style=color:#f92672>+</span><span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>y</span>) );
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// consider replacing this by a proper noise function
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>noise</span>( <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>x</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>x</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fract</span>(<span style=color:#a6e22e>x</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>f</span><span style=color:#f92672>*</span><span style=color:#a6e22e>f</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>3.0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>f</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>hash</span>(<span style=color:#a6e22e>p</span><span style=color:#f92672>+</span><span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>));
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>float</span> <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>hash</span>(<span style=color:#a6e22e>p</span><span style=color:#f92672>+</span><span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>0</span>));
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>float</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>hash</span>(<span style=color:#a6e22e>p</span><span style=color:#f92672>+</span><span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>float</span> <span style=color:#a6e22e>d</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>hash</span>(<span style=color:#a6e22e>p</span><span style=color:#f92672>+</span><span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>mix</span>(<span style=color:#a6e22e>mix</span>( <span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span>,<span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>x</span>), <span style=color:#a6e22e>mix</span>( <span style=color:#a6e22e>c</span>, <span style=color:#a6e22e>d</span>,<span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>x</span>),<span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>y</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mat2</span> <span style=color:#a6e22e>mtx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mat2</span>( <span style=color:#ae81ff>0.80</span>,  <span style=color:#ae81ff>0.60</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0.60</span>,  <span style=color:#ae81ff>0.80</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>fbm4</span>( <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>p</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.5000</span><span style=color:#f92672>*</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>1.0</span><span style=color:#f92672>+</span><span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> )); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mtx</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.02</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.2500</span><span style=color:#f92672>*</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>1.0</span><span style=color:#f92672>+</span><span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> )); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mtx</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.03</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.1250</span><span style=color:#f92672>*</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>1.0</span><span style=color:#f92672>+</span><span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> )); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mtx</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.01</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.0625</span><span style=color:#f92672>*</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>1.0</span><span style=color:#f92672>+</span><span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> ));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>f</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0.9375</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>fbm6</span>( <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>p</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.500000</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> ); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mtx</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.02</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.250000</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> ); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mtx</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.03</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.125000</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> ); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mtx</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.01</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.062500</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> ); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mtx</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.04</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.031250</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> ); <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mtx</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.01</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.015625</span><span style=color:#f92672>*</span><span style=color:#a6e22e>noise</span>( <span style=color:#a6e22e>p</span> );
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>f</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0.96875</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>fbm4_2</span>( <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>p</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>vec2</span>( <span style=color:#a6e22e>fbm4</span>(<span style=color:#a6e22e>p</span><span style=color:#f92672>+</span><span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>1.0</span>)), <span style=color:#a6e22e>fbm4</span>(<span style=color:#a6e22e>p</span><span style=color:#f92672>+</span><span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>6.2</span>)) );
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>fbm6_2</span>( <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>p</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>vec2</span>( <span style=color:#a6e22e>fbm6</span>(<span style=color:#a6e22e>p</span><span style=color:#f92672>+</span><span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>9.2</span>)), <span style=color:#a6e22e>fbm6</span>(<span style=color:#a6e22e>p</span><span style=color:#f92672>+</span><span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>5.7</span>)) );
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>func</span>( <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>q</span>, <span style=color:#a6e22e>out</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>o</span>, <span style=color:#a6e22e>out</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>n</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>q</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.05</span><span style=color:#f92672>*</span><span style=color:#a6e22e>sin</span>(<span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>0.11</span>,<span style=color:#ae81ff>0.13</span>)<span style=color:#f92672>*</span><span style=color:#a6e22e>u_time</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>length</span>( <span style=color:#a6e22e>q</span> )<span style=color:#f92672>*</span><span style=color:#ae81ff>4.0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>q</span> <span style=color:#f92672>*=</span> <span style=color:#ae81ff>0.7</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.2</span><span style=color:#f92672>*</span><span style=color:#a6e22e>cos</span>(<span style=color:#ae81ff>0.05</span><span style=color:#f92672>*</span><span style=color:#a6e22e>u_time</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>o</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>fbm4_2</span>( <span style=color:#a6e22e>q</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>o</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.02</span><span style=color:#f92672>*</span><span style=color:#a6e22e>sin</span>(<span style=color:#a6e22e>vec2</span>(<span style=color:#ae81ff>0.13</span>,<span style=color:#ae81ff>0.11</span>)<span style=color:#f92672>*</span><span style=color:#a6e22e>u_time</span><span style=color:#f92672>*</span><span style=color:#a6e22e>length</span>( <span style=color:#a6e22e>o</span> ));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>n</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fbm6_2</span>( <span style=color:#ae81ff>4.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>o</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>q</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>n</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1.0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>fbm4</span>( <span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mix</span>( <span style=color:#a6e22e>f</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>*</span><span style=color:#a6e22e>f</span><span style=color:#f92672>*</span><span style=color:#a6e22e>f</span><span style=color:#f92672>*</span><span style=color:#ae81ff>3.5</span>, <span style=color:#a6e22e>f</span><span style=color:#f92672>*</span><span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>x</span>) );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>f</span> <span style=color:#f92672>*=</span> <span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>pow</span>( <span style=color:#ae81ff>0.5</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>sin</span>(<span style=color:#ae81ff>8.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>x</span>)<span style=color:#f92672>*</span><span style=color:#a6e22e>sin</span>(<span style=color:#ae81ff>8.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>y</span>), <span style=color:#ae81ff>8.0</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>f</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> <span style=color:#a6e22e>funcs</span>( <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>q</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>t1</span>, <span style=color:#a6e22e>t2</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>func</span>(<span style=color:#a6e22e>q</span>,<span style=color:#a6e22e>t1</span>,<span style=color:#a6e22e>t2</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>void</span> )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>tot</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>AA</span><span style=color:#f92672>&gt;</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>( <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>mi</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>mi</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>AA</span>; <span style=color:#a6e22e>mi</span><span style=color:#f92672>++</span> )
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>( <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>ni</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>ni</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>AA</span>; <span style=color:#a6e22e>ni</span><span style=color:#f92672>++</span> )
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// pixel coordinates
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>vec2</span> <span style=color:#66d9ef>of</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec2</span>(<span style=color:#66d9ef>float</span>(<span style=color:#a6e22e>mi</span>),<span style=color:#66d9ef>float</span>(<span style=color:#a6e22e>ni</span>)) <span style=color:#f92672>/</span> <span style=color:#66d9ef>float</span>(<span style=color:#a6e22e>AA</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>q</span> <span style=color:#f92672>=</span> (<span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span>(<span style=color:#a6e22e>gl_FragCoord</span><span style=color:#f92672>+</span><span style=color:#66d9ef>of</span>)<span style=color:#f92672>-</span><span style=color:#a6e22e>u_resolution</span>.<span style=color:#a6e22e>xy</span>)<span style=color:#f92672>/</span><span style=color:#a6e22e>u_resolution</span>.<span style=color:#a6e22e>y</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>q</span> <span style=color:#f92672>=</span> (<span style=color:#ae81ff>2.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>gl_FragCoord</span>.<span style=color:#a6e22e>xy</span><span style=color:#f92672>-</span><span style=color:#a6e22e>u_resolution</span>.<span style=color:#a6e22e>xy</span>)<span style=color:#f92672>/</span><span style=color:#a6e22e>u_resolution</span>.<span style=color:#a6e22e>y</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>endif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>o</span>, <span style=color:#a6e22e>n</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>func</span>(<span style=color:#a6e22e>q</span>, <span style=color:#a6e22e>o</span>, <span style=color:#a6e22e>n</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.2</span>,<span style=color:#ae81ff>0.1</span>,<span style=color:#ae81ff>0.4</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mix</span>( <span style=color:#a6e22e>col</span>, <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.3</span>,<span style=color:#ae81ff>0.05</span>,<span style=color:#ae81ff>0.05</span>), <span style=color:#a6e22e>f</span> );
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mix</span>( <span style=color:#a6e22e>col</span>, <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.9</span>,<span style=color:#ae81ff>0.9</span>,<span style=color:#ae81ff>0.9</span>), <span style=color:#a6e22e>dot</span>(<span style=color:#a6e22e>n</span>,<span style=color:#a6e22e>n</span>) );
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mix</span>( <span style=color:#a6e22e>col</span>, <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.5</span>,<span style=color:#ae81ff>0.2</span>,<span style=color:#ae81ff>0.2</span>), <span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>o</span>.<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>o</span>.<span style=color:#a6e22e>y</span> );
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mix</span>( <span style=color:#a6e22e>col</span>, <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.0</span>,<span style=color:#ae81ff>0.2</span>,<span style=color:#ae81ff>0.4</span>), <span style=color:#ae81ff>0.5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>smoothstep</span>(<span style=color:#ae81ff>1.2</span>,<span style=color:#ae81ff>1.3</span>,<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>y</span>)<span style=color:#f92672>+</span><span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>x</span>)) );
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>col</span> <span style=color:#f92672>*=</span> <span style=color:#a6e22e>f</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2.0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>ex</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec2</span>( <span style=color:#ae81ff>1.0</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>u_resolution</span>.<span style=color:#a6e22e>x</span>, <span style=color:#ae81ff>0.0</span> );
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>ey</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec2</span>( <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>1.0</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>u_resolution</span>.<span style=color:#a6e22e>y</span> );
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>AA</span><span style=color:#f92672>&gt;</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ex</span> <span style=color:#f92672>/=</span> <span style=color:#66d9ef>float</span>(<span style=color:#a6e22e>AA</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ey</span> <span style=color:#f92672>/=</span> <span style=color:#66d9ef>float</span>(<span style=color:#a6e22e>AA</span>);
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>endif</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>nor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>normalize</span>( <span style=color:#a6e22e>vec3</span>( <span style=color:#a6e22e>funcs</span>(<span style=color:#a6e22e>q</span><span style=color:#f92672>+</span><span style=color:#a6e22e>ex</span>) <span style=color:#f92672>-</span> <span style=color:#a6e22e>f</span>, <span style=color:#a6e22e>ex</span>.<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>funcs</span>(<span style=color:#a6e22e>q</span><span style=color:#f92672>+</span><span style=color:#a6e22e>ey</span>) <span style=color:#f92672>-</span> <span style=color:#a6e22e>f</span> ) );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>lig</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>normalize</span>( <span style=color:#a6e22e>vec3</span>( <span style=color:#ae81ff>0.9</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0.2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0.4</span> ) );
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> <span style=color:#a6e22e>dif</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>clamp</span>( <span style=color:#ae81ff>0.3</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0.7</span><span style=color:#f92672>*</span><span style=color:#a6e22e>dot</span>( <span style=color:#a6e22e>nor</span>, <span style=color:#a6e22e>lig</span> ), <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>1.0</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>vec3</span> <span style=color:#a6e22e>lin</span>  <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.85</span>,<span style=color:#ae81ff>0.90</span>,<span style=color:#ae81ff>0.95</span>)<span style=color:#f92672>*</span>(<span style=color:#a6e22e>nor</span>.<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0.5</span><span style=color:#f92672>+</span><span style=color:#ae81ff>0.5</span>);
</span></span><span style=display:flex><span>             <span style=color:#a6e22e>lin</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>0.15</span>,<span style=color:#ae81ff>0.10</span>,<span style=color:#ae81ff>0.05</span>)<span style=color:#f92672>*</span><span style=color:#a6e22e>dif</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>col</span> <span style=color:#f92672>*=</span> <span style=color:#a6e22e>lin</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>1.0</span>)<span style=color:#f92672>-</span><span style=color:#a6e22e>col</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>col</span><span style=color:#f92672>*</span><span style=color:#a6e22e>col</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>col</span> <span style=color:#f92672>*=</span> <span style=color:#a6e22e>vec3</span>(<span style=color:#ae81ff>1.2</span>,<span style=color:#ae81ff>1.25</span>,<span style=color:#ae81ff>1.2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>tot</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>col</span>;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>AA</span><span style=color:#f92672>&gt;</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tot</span> <span style=color:#f92672>/=</span> <span style=color:#66d9ef>float</span>(<span style=color:#a6e22e>AA</span><span style=color:#f92672>*</span><span style=color:#a6e22e>AA</span>);
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>endif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>vec2</span> <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>gl_FragCoord</span>.<span style=color:#a6e22e>xy</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>u_resolution</span>.<span style=color:#a6e22e>xy</span>;
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>tot</span> <span style=color:#f92672>*=</span> <span style=color:#ae81ff>0.5</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.5</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>sqrt</span>(<span style=color:#ae81ff>16.0</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>y</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>x</span>)<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span><span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>y</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>gl_FragColor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec4</span>( <span style=color:#a6e22e>tot</span>, <span style=color:#ae81ff>1.0</span> );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><br><div align=center><iframe src=https://editor.p5js.org/wnarevalor/full/1QGOKGsSI width=700 height=700></iframe></div><br><h2 id=iv-conclusiones><strong>IV. Conclusiones</strong>
<a class=anchor href=#iv-conclusiones>#</a></h2><p>Se evidenció claramente como el uso de shaders para operaciones como el procesamiento de imágenes, el mapeo de texturas y el texturizado procedimental permite la obtención de resultados altamente eficientes, debido a la capacidad de cómputo de las GPU y los cálculos sobre hardware, comparados con este mismo tipo de procedimientos basados en implementaciones de software. Además, se pudo aprovechar el uso de librerías como p5.treegl que facilitan bastante procedimientos que de otra forma serían más complejos, como la lectura de shaders únicamente con el fragment shader mediante la función readShader de la misma librería, o la manipulación espacial que nos otorga p5.js con el método orbitControl para formas tridimensionales. Similarmente, fue posible evidenciar que existe un gran repertorio de contenido respecto a shaders creado por la comunidad, el cual es sumamemnte útil para aprender y experimentar la manipulación y creación de imágenes digitales.</p><h2 id=v-referencias><strong>V. Referencias</strong>
<a class=anchor href=#v-referencias>#</a></h2><ul><li>Patricio Gonzalez Vivo. (2015). The Book of Shaders. <a href=https://thebookofshaders.com/01/>Getting Started</a></li><li>Visual Computing. (2022). Texturing/ Image Processing/ Procedural Texturing. <a href=https://visualcomputing.github.io/docs/shaders/>Visual Computing Website</a></li><li>Wikipedia contributors. (2022). Texture mapping. Wikipedia. <a href=https://en.wikipedia.org/wiki/Texture_mapping>Wikipedia</a></li><li>Wikipedia contributors. (2022). Digital image processing. Wikipedia. <a href=https://en.wikipedia.org/wiki/Digital_image_processing>Wikipedia</a></li><li>Nakednous & dangulos @github. (2022). VisualComputing/p5.treegl. <a href=https://github.com/VisualComputing/p5.treegl>p5.treegl</a></li><li>WebGLFundamentals. (2015). WebGL Image Processing. <a href=https://webglfundamentals.org/webgl/lessons/webgl-image-processing.html#toc>WebGLFundamentals</a></li><li>Wawan60. (2015). Shadertoy - Magnifier. <a href=https://www.shadertoy.com/view/llsSz7>Source</a></li><li>Inigo Quilez. (2013). Shadertoy - Warping - procedural 1. <a href=https://www.shadertoy.com/view/4s23zz>Source</a></li><li>Inigo Quilez. (2013). Shadertoy - Warping - procedural 2. <a href=https://www.shadertoy.com/view/lsl3RH>Source</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/visualcomputing/showcase/commit/cf939e29a6bb072d214d494563785388a2edb572 title='Last modified by Wilson Arevalo | June 28, 2022' target=_blank rel=noopener><img src=/VisualComputing-Showcase/svg/calendar.svg class=book-icon alt=Calendar>
<span>June 28, 2022</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#shaders><strong>Shaders</strong></a><ul><li><a href=#i-introducción><strong>I. Introducción</strong></a></li><li><a href=#texturing-and-coloring><strong>Texturing and Coloring</strong></a></li><li><a href=#i-introducción-1><strong>I. Introducción</strong></a></li><li><a href=#ii-contextualización><strong>II. Contextualización</strong></a></li><li><a href=#iii-resultados><strong>III. Resultados</strong></a></li><li><a href=#image-processing><strong>Image Processing</strong></a></li><li><a href=#i-introducción-2><strong>I. Introducción</strong></a></li><li><a href=#ii-contextualización-1><strong>II. Contextualización</strong></a></li><li><a href=#iii-resultados-1><strong>III. Resultados</strong></a></li><li><a href=#procedural-texturing><strong>Procedural Texturing</strong></a></li><li><a href=#i-introducción-3><strong>I. Introducción</strong></a></li><li><a href=#ii-contextualización-2><strong>II. Contextualización</strong></a></li><li><a href=#iii-resultados-2><strong>III. Resultados</strong></a></li><li><a href=#iv-conclusiones><strong>IV. Conclusiones</strong></a></li><li><a href=#v-referencias><strong>V. Referencias</strong></a></li></ul></li></ul></nav></div></aside></main></body></html>